import{a as Z}from"./chunk-WKW57PVX.js";import{b as J,d as K,f as X,p as Y}from"./chunk-B6CTW34R.js";import{b as Q,g as z,h as B,i as H,j as $,q as W,r as G}from"./chunk-UEBHN7X3.js";import{Ab as y,Cb as o,Cc as N,Db as n,Dc as D,Eb as d,Fb as C,Gb as u,Ha as f,Hb as m,Ic as F,N as O,P as E,Qb as l,Rb as b,Sb as v,T as L,Vb as j,Wb as V,Xb as A,aa as R,bb as T,cb as s,d as M,ga as I,j as P,ma as x,mb as U,qb as g,t as k,ua as _,va as h,xb as p,zb as S}from"./chunk-HT5E4KE5.js";var w=class r{http=x(Q);apiUrl=`${W.apiUrl}/tasks`;globalSearch(t,e=20){return this.http.get(`${this.apiUrl}/search/global`,{params:{q:t,limit:e.toString()}})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=I({token:r,factory:r.\u0275fac,providedIn:"root"})};function te(r,t){if(r&1){let e=C();o(0,"span",31)(1,"i",32),u("click",function(){_(e);let a=m();return h(a.clearSearch())}),n()()}}function ne(r,t){r&1&&(o(0,"div",33)(1,"div",34)(2,"span",35),l(3,"Buscando..."),n()(),l(4," Buscando... "),n())}function re(r,t){if(r&1&&(o(0,"small",46),l(1),n()),r&2){let e=m().$implicit;s(),v(" ",e.description.length>50?e.description.substring(0,50)+"...":e.description," ")}}function ie(r,t){if(r&1){let e=C();o(0,"a",40),u("click",function(){let a=_(e).$implicit,c=m(3);return h(c.selectSearchResult("project",a.id))}),o(1,"div",41),d(2,"i",42),n(),o(3,"div",43)(4,"div",44),l(5),n(),g(6,re,2,1,"small",45),n()()}if(r&2){let e=t.$implicit;s(5),b(e.name),s(),p("ngIf",e.description)}}function oe(r,t){r&1&&d(0,"div",47)}function ae(r,t){if(r&1&&(o(0,"div")(1,"h6",37),d(2,"i",11),l(3,"Proyectos "),n(),g(4,ie,7,2,"a",38)(5,oe,1,0,"div",39),n()),r&2){let e,i=m(2);s(4),p("ngForOf",i.searchResults().projects),s(),p("ngIf",((e=i.searchResults())==null?null:e.tasks)&&i.searchResults().tasks.length>0)}}function se(r,t){if(r&1&&(o(0,"span",52),d(1,"i",53),l(2),n()),r&2){let e=m().$implicit;s(),y("text-"+(e.priority==="high"?"danger":e.priority==="medium"?"warning":"secondary")),s(),v(" ",e.priority==="high"?"Alta":e.priority==="medium"?"Media":"Baja"," ")}}function ce(r,t){if(r&1){let e=C();o(0,"a",40),u("click",function(){let a=_(e).$implicit,c=m(3);return h(c.selectSearchResult("task",a.id))}),o(1,"div",41)(2,"span",49),l(3),n()(),o(4,"div",43)(5,"div",44),l(6),n(),o(7,"small",46),d(8,"i",50),l(9),g(10,se,3,3,"span",51),n()()()}if(r&2){let e=t.$implicit,i=m(3);s(2),y("badge-"+(e.status===i.TaskStatus.CREATED?"secondary":e.status===i.TaskStatus.IN_PROGRESS?"warning":"success")),s(),v(" ",e.status===i.TaskStatus.CREATED?"Por hacer":e.status===i.TaskStatus.IN_PROGRESS?"En progreso":"Completada"," "),s(3),b(e.title),s(3),v("",e.project==null?null:e.project.name," "),s(),p("ngIf",e.priority)}}function le(r,t){if(r&1&&(o(0,"div")(1,"h6",48),d(2,"i",15),l(3,"Tareas "),n(),g(4,ce,11,6,"a",38),n()),r&2){let e=m(2);s(4),p("ngForOf",e.searchResults().tasks)}}function de(r,t){if(r&1&&(o(0,"div",54),d(1,"i",55),l(2),n()),r&2){let e=m(2);s(2),v(' No se encontraron resultados para "',e.searchQuery,'" ')}}function me(r,t){if(r&1&&(o(0,"div"),g(1,ae,6,2,"div",26)(2,le,5,1,"div",26)(3,de,3,1,"div",36),n()),r&2){let e,i,a,c=m();s(),p("ngIf",((e=c.searchResults())==null?null:e.projects)&&c.searchResults().projects.length>0),s(),p("ngIf",((i=c.searchResults())==null?null:i.tasks)&&c.searchResults().tasks.length>0),s(),p("ngIf",(!((a=c.searchResults())!=null&&a.projects)||c.searchResults().projects.length===0)&&(!((a=c.searchResults())!=null&&a.tasks)||c.searchResults().tasks.length===0))}}function pe(r,t){if(r&1){let e=C();o(0,"div",56)(1,"button",57),u("click",function(){_(e);let a=m();return h(a.toggleUserMenu())}),o(2,"div",58),l(3),n(),o(4,"span",59),l(5),n()(),o(6,"ul",60)(7,"li",61)(8,"div",62),l(9),n(),o(10,"small",46),l(11),n()(),o(12,"li"),d(13,"hr",47),n(),o(14,"li")(15,"a",63),u("click",function(){_(e);let a=m();return h(a.showUserMenu.set(!1))}),d(16,"i",64),l(17,"Cuenta "),n()(),o(18,"li")(19,"a",65),u("click",function(){_(e);let a=m();return h(a.showUserMenu.set(!1))}),d(20,"i",66),l(21,"Configuraci\xF3n "),n()(),o(22,"li"),d(23,"hr",47),n(),o(24,"li")(25,"button",67),u("click",function(){_(e);let a=m();return h(a.logout())}),d(26,"i",68),l(27,"Cerrar Sesi\xF3n "),n()()()()}if(r&2){let e,i,a,c=m();s(3),v(" ",c.getUserInitials()," "),s(2),b(((e=c.currentUser())==null?null:e.name)||"User"),s(),S("show",c.showUserMenu()),s(3),b(((i=c.currentUser())==null?null:i.name)||"User"),s(2),b((a=c.currentUser())==null?null:a.email)}}var q=class r{authService=x(G);router=x(B);searchService=x(w);sidebarCollapsed=f(!1);currentUser=f(null);showUserMenu=f(!1);searchQuery="";searchResults=f(null);showSearchResults=f(!1);isSearching=f(!1);searchSubject=new P;TaskStatus=Z;constructor(){this.authService.getUserData().subscribe(t=>{this.currentUser.set(t)}),this.setupSearch()}toggleSidebar(){this.sidebarCollapsed.update(t=>!t)}toggleUserMenu(){this.showUserMenu.update(t=>!t)}getUserInitials(){let t=this.currentUser();if(!t)return"U";if(t.name){let e=t.name.split(" ");return e.length>=2?(e[0][0]+e[1][0]).toUpperCase():e[0][0].toUpperCase()}return t.email?t.email[0].toUpperCase():"U"}logout(){return M(this,null,function*(){yield this.authService.logout(),this.showUserMenu.set(!1)})}setupSearch(){this.searchSubject.pipe(E(300),L(),R(t=>!t||t.length<2?(this.showSearchResults.set(!1),k(null)):(this.isSearching.set(!0),this.searchService.globalSearch(t).pipe(O(e=>(console.error("Error searching:",e),k(null))))))).subscribe(t=>{this.isSearching.set(!1),t?(this.searchResults.set(t),this.showSearchResults.set(!0)):(this.searchResults.set(null),this.showSearchResults.set(!1))})}onSearchInput(t){let e=t.target;this.searchQuery=e.value,this.searchSubject.next(this.searchQuery)}selectSearchResult(t,e){if(this.showSearchResults.set(!1),this.searchQuery="",t==="task"){let a=this.searchResults()?.tasks.find(c=>c.id===e);a&&this.router.navigate(["/projects",a.projectId])}else this.router.navigate(["/projects",e])}clearSearch(){this.searchQuery="",this.searchResults.set(null),this.showSearchResults.set(!1)}onDocumentClick(t){let e=t.target,i=e.closest(".dropdown"),a=e.closest(".search-container");i||this.showUserMenu.set(!1),a||this.showSearchResults.set(!1)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=U({type:r,selectors:[["app-layout"]],hostBindings:function(e,i){e&1&&u("click",function(c){return i.onDocumentClick(c)},!1,T)},decls:42,vars:7,consts:[[1,"app-layout"],[1,"navbar","navbar-expand-lg","navbar-light","bg-white","border-bottom","sticky-top"],[1,"container-fluid","px-4"],["href","#","routerLink","/dashboard",1,"navbar-brand","fw-bold"],[1,"fas","fa-check-circle","text-primary","me-2"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto"],[1,"nav-item"],["routerLink","/dashboard","routerLinkActive","active",1,"nav-link"],[1,"fas","fa-home","me-2"],["routerLink","/projects","routerLinkActive","active",1,"nav-link"],[1,"fas","fa-folder","me-2"],["routerLink","/board","routerLinkActive","active",1,"nav-link"],[1,"fas","fa-th-large","me-2"],["routerLink","/tasks","routerLinkActive","active",1,"nav-link"],[1,"fas","fa-tasks","me-2"],["routerLink","/calendar","routerLinkActive","active",1,"nav-link"],[1,"fas","fa-calendar","me-2"],[1,"d-flex","align-items-center","me-3","position-relative","search-container"],[1,"input-group","input-group-sm",2,"width","300px"],[1,"input-group-text","bg-transparent","border-end-0"],[1,"fas","fa-search","text-muted"],["type","text","placeholder","Buscar tareas, proyectos...","autocomplete","off",1,"form-control","border-start-0",3,"ngModelChange","input","ngModel"],["class","input-group-text bg-transparent border-start-0",4,"ngIf"],[1,"search-results","dropdown-menu","shadow-lg",2,"width","100%","max-height","400px","overflow-y","auto","z-index","1050"],["class","dropdown-item-text text-center py-3",4,"ngIf"],[4,"ngIf"],["class","dropdown",4,"ngIf"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNav",1,"navbar-toggler"],[1,"navbar-toggler-icon"],[1,"main-content"],[1,"input-group-text","bg-transparent","border-start-0"],[1,"fas","fa-times","text-muted","cursor-pointer",3,"click"],[1,"dropdown-item-text","text-center","py-3"],["role","status",1,"spinner-border","spinner-border-sm","text-primary","me-2"],[1,"visually-hidden"],["class","dropdown-item-text text-center py-3 text-muted",4,"ngIf"],[1,"dropdown-header","text-primary"],["class","dropdown-item d-flex align-items-center py-2",3,"click",4,"ngFor","ngForOf"],["class","dropdown-divider",4,"ngIf"],[1,"dropdown-item","d-flex","align-items-center","py-2",3,"click"],[1,"me-3"],[1,"fas","fa-folder","text-primary"],[1,"flex-grow-1"],[1,"fw-medium"],["class","text-muted",4,"ngIf"],[1,"text-muted"],[1,"dropdown-divider"],[1,"dropdown-header","text-success"],[1,"badge"],[1,"fas","fa-folder","me-1"],["class","ms-2",4,"ngIf"],[1,"ms-2"],[1,"fas","fa-flag","me-1"],[1,"dropdown-item-text","text-center","py-3","text-muted"],[1,"fas","fa-search-minus","me-2"],[1,"dropdown"],["type","button",1,"btn","btn-outline-secondary","dropdown-toggle","d-flex","align-items-center",3,"click"],[1,"user-avatar","me-2"],[1,"d-none","d-md-inline"],[1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-header"],[1,"fw-bold"],["routerLink","/account",1,"dropdown-item",3,"click"],[1,"fas","fa-user","me-2"],["routerLink","/settings",1,"dropdown-item",3,"click"],[1,"fas","fa-cog","me-2"],[1,"dropdown-item","text-danger",3,"click"],[1,"fas","fa-sign-out-alt","me-2"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"header",1)(2,"div",2)(3,"a",3),d(4,"i",4),l(5," TodoList "),n(),o(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),d(10,"i",9),l(11,"Panel "),n()(),o(12,"li",7)(13,"a",10),d(14,"i",11),l(15,"Proyectos "),n()(),o(16,"li",7)(17,"a",12),d(18,"i",13),l(19,"Tablero "),n()(),o(20,"li",7)(21,"a",14),d(22,"i",15),l(23,"Tareas "),n()(),o(24,"li",7)(25,"a",16),d(26,"i",17),l(27,"Calendario "),n()()(),o(28,"div",18)(29,"div",19)(30,"span",20),d(31,"i",21),n(),o(32,"input",22),A("ngModelChange",function(c){return V(i.searchQuery,c)||(i.searchQuery=c),c}),u("input",function(c){return i.onSearchInput(c)}),n(),g(33,te,2,0,"span",23),n(),o(34,"div",24),g(35,ne,5,0,"div",25)(36,me,4,3,"div",26),n()(),g(37,pe,28,6,"div",27),n(),o(38,"button",28),d(39,"span",29),n()()(),o(40,"main",30),d(41,"router-outlet"),n()()),e&2&&(s(32),j("ngModel",i.searchQuery),s(),p("ngIf",i.searchQuery),s(),S("show",i.showSearchResults()),s(),p("ngIf",i.isSearching()),s(),p("ngIf",!i.isSearching()&&i.searchResults()),s(),p("ngIf",i.currentUser()))},dependencies:[F,N,D,Y,J,K,X,z,H,$],styles:[".app-layout[_ngcontent-%COMP%]{min-height:100vh;background-color:#f8fafc}.main-content[_ngcontent-%COMP%]{min-height:calc(100vh - 76px);background-color:#f8fafc}.user-avatar[_ngcontent-%COMP%]{width:32px;height:32px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:600}.navbar[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}.navbar[_ngcontent-%COMP%]   .navbar-brand[_ngcontent-%COMP%]{font-size:1.25rem;color:#1f2937!important}.navbar[_ngcontent-%COMP%]   .navbar-brand[_ngcontent-%COMP%]:hover{color:#2563eb!important}.navbar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{font-weight:500;color:#6b7280!important;padding:.5rem 1rem!important;border-radius:.375rem;margin:0 .25rem;transition:all .2s ease-in-out}.navbar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;color:#374151!important}.navbar[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background-color:#dbeafe;color:#2563eb!important}.search-container[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{background-color:transparent;border-color:#d1d5db}.search-container[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-color:#d1d5db}.search-container[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#2563eb;box-shadow:0 0 0 .2rem #2563eb40}.search-container[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;margin-top:.25rem;border:1px solid #e5e7eb;background-color:#fff;border-radius:.5rem;z-index:1050}.search-container[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .dropdown-header[_ngcontent-%COMP%]{padding:.5rem 1rem;background-color:#f9fafb;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border-bottom:1px solid #e5e7eb;margin-bottom:0}.search-container[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{padding:.75rem 1rem;border:none;transition:background-color .15s ease-in-out;cursor:pointer}.search-container[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;text-decoration:none}.search-container[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.65rem;padding:.25rem .5rem}.search-container[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   .badge.badge-secondary[_ngcontent-%COMP%]{background-color:#6b7280}.search-container[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   .badge.badge-warning[_ngcontent-%COMP%]{background-color:#f59e0b}.search-container[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   .badge.badge-success[_ngcontent-%COMP%]{background-color:#10b981}.search-container[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .dropdown-item-text[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.dropdown-menu[_ngcontent-%COMP%]{border:1px solid #e5e7eb;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;border-radius:.5rem}.dropdown-menu[_ngcontent-%COMP%]   .dropdown-header[_ngcontent-%COMP%]{padding:.75rem 1rem;background-color:#f9fafb;border-bottom:1px solid #e5e7eb}.dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{padding:.5rem 1rem}.dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.dropdown-menu[_ngcontent-%COMP%]   .dropdown-item.text-danger[_ngcontent-%COMP%]:hover{background-color:#fef2f2;color:#dc2626!important}@media (max-width: 768px){.main-content[_ngcontent-%COMP%]{min-height:calc(100vh - 56px)}.navbar-brand[_ngcontent-%COMP%]{font-size:1.1rem}}"]})};export{q as LayoutComponent};
